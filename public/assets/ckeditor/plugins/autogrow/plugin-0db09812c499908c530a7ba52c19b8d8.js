/*
Copyright (c) 2003-2012, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/
!function(){function e(e){var t=e.getStyle("overflow-y"),o=e.getDocument(),n=CKEDITOR.dom.element.createFromHtml('<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(CKEDITOR.env.webkit?"&nbsp;":"")+"</span>",o);o[CKEDITOR.env.ie?"getBody":"getDocumentElement"]().append(n);var i=n.getDocumentPosition(o).y+n.$.offsetHeight;return n.remove(),e.setStyle("overflow-y",t),i}var t=function(t){if(t.window){var o=t.document,n=(new CKEDITOR.dom.element(o.getWindow().$.frameElement),o.getBody()),i=o.getDocumentElement(),a=t.window.getViewPaneSize().height,r="BackCompat"==o.$.compatMode?n:i,m=e(r);m+=t.config.autoGrow_bottomSpace||0;var d=void 0!=t.config.autoGrow_minHeight?t.config.autoGrow_minHeight:200,g=t.config.autoGrow_maxHeight||1/0;m=Math.max(m,d),m=Math.min(m,g),m!=a&&(m=t.fire("autoGrow",{currentHeight:a,newHeight:m}).newHeight,t.resize(t.container.getStyle("width"),m,!0)),r.$.scrollHeight>r.$.clientHeight&&g>m?r.setStyle("overflow-y","hidden"):r.removeStyle("overflow-y")}};CKEDITOR.plugins.add("autogrow",{init:function(e){e.addCommand("autogrow",{exec:t,modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});var o={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1};e.config.autoGrow_onStartup&&(o.instanceReady=1);for(var n in o)e.on(n,function(o){var n=e.getCommand("maximize");"wysiwyg"!=o.editor.mode||n&&n.state==CKEDITOR.TRISTATE_ON||setTimeout(function(){t(o.editor),t(o.editor)},100)})}})}();